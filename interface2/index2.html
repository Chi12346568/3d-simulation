<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Interactive Stack Example</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        background: #f9f9f9;
        margin: 0;
        padding: 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
      }
      .container {
        background: white;
        border: 1px solid #ccc;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        padding: 20px;
        width: 700px;
      }
      h2 {
        color: #333366;
      }
      .interactive-box {
        background-color: #eaf1fb;
        padding: 20px;
        border: 2px solid #99c2ff;
        border-radius: 6px;
        margin-top: 15px;
      }
      .button-group {
        margin-top: 20px;
        display: flex;
        justify-content: flex-end;
        gap: 15px;
      }
      .button-group button {
        padding: 10px 20px;
        border: none;
        border-radius: 6px;
        background-color: #b2f0b2;
        cursor: pointer;
        transition: background-color 0.2s;
      }
      .button-group button:hover {
        background-color: #a0e0a0;
      }
      .editor {
        display: none;
        margin-top: 15px;
      }
      textarea {
        width: 100%;
        height: 150px;
        padding: 10px;
        font-size: 14px;
        border-radius: 5px;
        border: 1px solid #ccc;
      }

      .lang-select select {
        padding: 6px 10px;
        font-size: 14px;
        border: 1px solid #aaa;
        border-radius: 4px;
      }

      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }
      .header h2 {
        margin: 0;
        font-size: 24px;
        color: #233dd2;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Language Switcher -->

      <div class="header">
        <div>
          <h2>Proposed Concrete Example</h2>
          <p><strong>Discover and Review your Realâ€“World Example</strong></p>
        </div>
        <div class="lang-select">
          <select id="language" onchange="changeLanguage(this.value)">
            <option value="en">ğŸŒ ENG</option>
            <option value="fr">ğŸŒ FR</option>
            <option value="ar">ğŸŒ AR</option>
          </select>
        </div>
      </div>
      <div id="displayBox" class="interactive-box">
        A real-life example of a stack is a stack of books on a desk.<br />
        <strong>How it Works:</strong><br />
        1. When you add a new book to the stack, it goes on top of the pile
        (pushed onto the stack).<br />
        2. When you need a book, you take the top book from the stack (pop from
        the stack).<br />
        3. The last book you added is the first one youâ€™ll remove, following the
        LIFO (Last In, First Out) principle.<br />
        So, the most recently placed book is the first one you grab, just like
        how elements are added and removed from a stack in programming.<br />
        Let me know if you want to dive deeper into this!
      </div>

      <div class="button-group">
        <button onclick="showEditor()">Refine</button>
        <button onclick="showFontEditor()">Edit Font or Style</button>
        <button onclick="regenerateText()">Regenerate</button>
        <button onclick="confirmText()">Confirm</button>
      </div>

      <div id="editor" class="editor">
        <textarea id="editBox"></textarea>
        <button onclick="applyChanges()" style="margin-top: 10px">Apply</button>
      </div>
    </div>

    <script>
      // OpenAI API key
      const OPENAI_API_KEY =
        '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'

      const displayBox = document.getElementById('displayBox')
      const editBox = document.getElementById('editBox')
      const editor = document.getElementById('editor')

      // Load the stored example on page load
      window.onload = function () {
        // Get the example from localStorage
        const example = localStorage.getItem('generatedExample')
        if (example) {
          displayBox.innerHTML = example.replace(/\n/g, '<br>')
        }

        // Add title information
        const courseTitle =
          localStorage.getItem('courseTitle') || 'Computer Science'
        const chapterTopic =
          localStorage.getItem('chapterTopic') || 'Data Structure'

        document.querySelector(
          'h2'
        ).textContent = `Proposed Concrete Example: ${chapterTopic}`
        document.title = `Interactive Example - ${courseTitle}`
      }

      function showEditor() {
        editBox.value = displayBox.innerText
        editor.style.display = 'block'
      }

      function applyChanges() {
        const updatedText = editBox.value.replace(/\n/g, '<br>')
        displayBox.innerHTML = updatedText
        editor.style.display = 'none'

        // Save the updated example
        localStorage.setItem('generatedExample', editBox.value)
      }

      function showFontEditor() {
        // Instead of opening a new window, redirect to interface3
        window.location.href = '../interface3/index3.html'
      }

      async function regenerateText() {
        displayBox.innerHTML = 'Regenerating example...'

        try {
          // Get the current prompt information
          const courseTitle =
            localStorage.getItem('courseTitle') || 'Computer Science'
          const chapterTopic =
            localStorage.getItem('chapterTopic') || 'Data Structure'
          const userPrompt =
            localStorage.getItem('userPrompt') ||
            'Explain a data structure concept'

          // Call OpenAI API with a slightly different prompt to get variation
          const response = await fetch(
            'https://api.openai.com/v1/chat/completions',
            {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
                Authorization: `Bearer ${OPENAI_API_KEY}`,
              },
              body: JSON.stringify({
                model: 'gpt-3.5-turbo',
                messages: [
                  {
                    role: 'system',
                    content:
                      'You are a helpful assistant providing alternative clear, concise real-world examples of computer science and programming concepts. Focus on creating examples that can be visualized in 3D.',
                  },
                  {
                    role: 'user',
                    content: `Course: ${courseTitle}
                                    Chapter: ${chapterTopic}
                                    I need a different example to illustrate: ${userPrompt}
                                    The example should be concrete, easy to understand, and possible to visualize in 3D.`,
                  },
                ],
                temperature: 0.8, // Slightly higher temperature for more variation
                max_tokens: 500,
              }),
            }
          )

          const result = await response.json()
          if (result.error) {
            throw new Error(result.error.message)
          }

          const regeneratedExample = result.choices[0].message.content

          // Update the display
          displayBox.innerHTML = regeneratedExample.replace(/\n/g, '<br>')

          // Save to localStorage
          localStorage.setItem('generatedExample', regeneratedExample)
        } catch (error) {
          console.error('Error regenerating example:', error)
          displayBox.innerHTML = 'Error regenerating example. Please try again.'
        }
      }

      function confirmText() {
        // Save the current example text
        const exampleText = displayBox.innerHTML
        localStorage.setItem('formattedExample', exampleText)

        // Navigate to interface3
        window.location.href = '../interface3/index3.html'
      }

      // Language switching functionality
      function changeLanguage(lang) {
        const title = document.querySelector('h2')
        const subtitle = document.querySelector('p')
        const buttons = document.querySelectorAll('.button-group button')

        // Change text direction for Arabic
        displayBox.style.direction = lang === 'ar' ? 'rtl' : 'ltr'
        displayBox.style.textAlign = lang === 'ar' ? 'right' : 'left'

        if (lang === 'en') {
          // English translations
          const chapterTopic =
            localStorage.getItem('chapterTopic') || 'Data Structure'
          title.textContent = `Proposed Concrete Example: ${chapterTopic}`
          subtitle.innerHTML =
            '<strong>Discover and Review your Realâ€“World Example</strong>'

          buttons[0].textContent = 'Refine'
          buttons[1].textContent = 'Edit Font or Style'
          buttons[2].textContent = 'Regenerate'
          buttons[3].textContent = 'Confirm'

          // If we have a stored English example, use it
          const example = localStorage.getItem('generatedExample')
          if (example) {
            displayBox.innerHTML = example.replace(/\n/g, '<br>')
          } else {
            displayBox.innerHTML = `
              A real-life example of a stack is a stack of books on a desk.<br />
              <strong>How it Works:</strong><br />
              1. When you add a new book to the stack, it goes on top of the pile
              (pushed onto the stack).<br />
              2. When you need a book, you take the top book from the stack (pop from
              the stack).<br />
              3. The last book you added is the first one you'll remove, following the
              LIFO (Last In, First Out) principle.<br />
              So, the most recently placed book is the first one you grab, just like
              how elements are added and removed from a stack in programming.<br />
              Let me know if you want to dive deeper into this!
            `
          }
        } else if (lang === 'fr') {
          // French translations
          const chapterTopic =
            localStorage.getItem('chapterTopic') || 'Structure de DonnÃ©es'
          title.textContent = `Exemple Concret ProposÃ©: ${chapterTopic}`
          subtitle.innerHTML =
            '<strong>DÃ©couvrez et rÃ©visez votre exemple du monde rÃ©el</strong>'

          buttons[0].textContent = 'Affiner'
          buttons[1].textContent = 'Modifier la police ou le style'
          buttons[2].textContent = 'RÃ©gÃ©nÃ©rer'
          buttons[3].textContent = 'Confirmer'

          displayBox.innerHTML = `
            Un exemple concret d'une pile est une <strong>pile de livres</strong> sur un bureau.<br />
            <strong>Comment Ã§a fonctionne:</strong><br />
            1. Quand vous ajoutez un nouveau livre Ã  la pile, il va au-dessus (poussÃ© sur la pile).<br />
            2. Quand vous avez besoin d'un livre, vous prenez le livre du dessus (dÃ©pilage).<br />
            3. Le dernier livre ajoutÃ© est le premier que vous retirerez, selon le principe LIFO (Dernier EntrÃ©, Premier Sorti).<br />
            Ainsi, le livre le plus rÃ©cemment placÃ© est le premier que vous prenez, comme dans une pile en programmation.<br />
            Faites-moi savoir si vous voulez approfondir ce sujet!
          `
        } else if (lang === 'ar') {
          // Arabic translations
          const chapterTopic =
            localStorage.getItem('chapterTopic') || 'Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'
          title.textContent = `Ù…Ø«Ø§Ù„ Ù…Ù„Ù…ÙˆØ³ Ù…Ù‚ØªØ±Ø­: ${chapterTopic}`
          subtitle.innerHTML =
            '<strong>Ø§ÙƒØªØ´Ù ÙˆØ±Ø§Ø¬Ø¹ Ù…Ø«Ø§Ù„Ùƒ Ù…Ù† Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ</strong>'

          buttons[0].textContent = 'ØªØ­Ø³ÙŠÙ†'
          buttons[1].textContent = 'ØªØ­Ø±ÙŠØ± Ø§Ù„Ø®Ø· Ø£Ùˆ Ø§Ù„Ù†Ù…Ø·'
          buttons[2].textContent = 'Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆÙ„ÙŠØ¯'
          buttons[3].textContent = 'ØªØ£ÙƒÙŠØ¯'

          displayBox.innerHTML = `
            Ù…Ø«Ø§Ù„ ÙˆØ§Ù‚Ø¹ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙƒØ¯Ø³ Ù‡Ùˆ <strong>ÙƒÙˆÙ…Ø© Ù…Ù† Ø§Ù„ÙƒØªØ¨</strong> Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙƒØªØ¨.<br />
            <strong>ÙƒÙŠÙ ÙŠØ¹Ù…Ù„:</strong><br />
            1. Ø¹Ù†Ø¯Ù…Ø§ ØªØ¶ÙŠÙ ÙƒØªØ§Ø¨Ù‹Ø§ Ø¬Ø¯ÙŠØ¯Ù‹Ø§ Ø¥Ù„Ù‰ Ø§Ù„ÙƒÙˆÙ…Ø©ØŒ ÙØ¥Ù†Ù‡ ÙŠÙˆØ¶Ø¹ ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰ (ÙŠÙØ¯ÙØ¹ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙƒØ¯Ø³).<br />
            2. Ø¹Ù†Ø¯Ù…Ø§ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ÙƒØªØ§Ø¨ØŒ ØªØ£Ø®Ø° Ø§Ù„ÙƒØªØ§Ø¨ Ø§Ù„Ø¹Ù„ÙˆÙŠ Ù…Ù† Ø§Ù„ÙƒÙˆÙ…Ø© (Ø³Ø­Ø¨ Ù…Ù† Ø§Ù„Ù…ÙƒØ¯Ø³).<br />
            3. Ø¢Ø®Ø± ÙƒØªØ§Ø¨ Ø£Ø¶ÙØªÙ‡ Ù‡Ùˆ Ø£ÙˆÙ„ Ù…Ù† Ø³ØªØ²ÙŠÙ„Ù‡ØŒ ÙˆÙÙ‚Ù‹Ø§ Ù„Ù…Ø¨Ø¯Ø£ LIFO (Ø¢Ø®Ø± Ù…Ù† ÙŠØ¯Ø®Ù„ØŒ Ø£ÙˆÙ„ Ù…Ù† ÙŠØ®Ø±Ø¬).<br />
            Ù„Ø°Ø§ØŒ ÙØ¥Ù† Ø§Ù„ÙƒØªØ§Ø¨ Ø§Ù„Ù…Ø¶Ø§Ù Ù…Ø¤Ø®Ø±Ù‹Ø§ Ù‡Ùˆ Ø£ÙˆÙ„ Ù…Ø§ ØªØ£Ø®Ø°Ù‡ØŒ ØªÙ…Ø§Ù…Ù‹Ø§ Ù…Ø«Ù„ Ø§Ù„Ø¹Ù†Ø§ØµØ± ÙÙŠ Ù…ÙƒØ¯Ø³ Ø§Ù„Ø¨Ø±Ù…Ø¬Ø©.<br />
            Ø£Ø®Ø¨Ø±Ù†ÙŠ Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ±ÙŠØ¯ Ø§Ù„ØªØ¹Ù…Ù‚ Ø£ÙƒØ«Ø± ÙÙŠ Ù‡Ø°Ø§!
          `
        }
      }
    </script>
  </body>
</html>
